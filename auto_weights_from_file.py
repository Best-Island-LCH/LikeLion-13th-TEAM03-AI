# === 자동 가중치: 업종 자연어 → 가중치 ===
# 이 블록을 main.py 상단(함수 정의들 위) 어딘가에 붙여넣으세요.

import re

FNB_KEYWORDS = [
    '간이', '경양식', '곱창', '곱창 전골/구이', '구내식당', '구내식당·뷔페', '구이', '국/탕/찌개류', '국수', '국수/칼국수', 
    '그 외 기타 간이 음식점', '기타 간이', '기타 동남아식 전문', '기타 서양식 음식점', '기타 외국', '기타 일식 음식점', '기타 한식 음식점', '김밥', 
    '김밥/만두/분식', '냉면', '냉면/밀면', '닭/오리고기 구이/찜', '덮밥', '도넛', '돈가스', '동남아시아', '동남아식', '돼지고기', 
    '돼지고기 구이/찜', '떡/한과', '마라탕', '마라탕/훠궈', '만두', '무도', '무도 유흥 주점', '밀면', '백반', '백반/한정식', '버거', 
    '베트남식', '베트남식 전문', '보쌈', '복 요리 전문', '부침개', '분류 안된 외국식 음식점', '분식', '뷔페', '비알코올', '빙수', '빵/도넛', 
    '샌드위치', '샐러드', '생맥주', '생맥주 전문', '서양식', '소고기', '소고기 구이/찜', '스테이크', '아이스크림', '아이스크림/빙수', '오리고기', 
    '외국', '외국식', '요리 주점', '우동', '원두', '원두 커피 전문점', '육류', '이탈리아식', '일본식', '일본식 음식점', '일식집', '자장면', 
    '즉석', '즉석 떡볶이 전문', '즉석 샐러드/과일', '즉석 죽 전문', '즉석 제빵 (도넛/페스트리 등)', '즉석 통닭 전문', '즉석/테이크아웃', '즉석식품', 
    '중국식', '중국식집', '중식', '찌개', '찜·탕·찌개', '찜닭', '채식·비건 음식점', '초밥', '치킨', '카레', '칼국수', '케익', '케익전문점', '쿠키', 
    '탕수육', '태국식', '테이크아웃', '토스트', '파스타', '패밀리레스토랑', '패스트푸드', '패스트푸드 전문점', '펍', '포장마차', '퓨전', 
    '퓨전 음식점', '퓨전 한식', '프랜차이즈 카페', '한과', '한식', '한식집', '햄버거', '햄버거/샌드위치', '호프', '호프/맥주', '회', '횟집', '후라이드', 
    '훠궈'
]

SERVICE_KEYWORDS = [
    'PC', 'PC/비디오게임', 'PC방', '간병', '가사', '가전', '가전제품 수리', '가정용 전기기기 수리', '가정용품 수리', 
    '가죽·모피제품 수리', '가죽/모피제품 수리', '가죽제품 수리', '가정 서비스', '건강', '결혼', '결혼 상담', '결혼/예식 서비스', '경비', '경비업', 
    '계측/측정', '계측기구 수리', '계측제어/측정/시험', '계측제어장치 수리', '골프', '공구류', '공예품/악기', '광학기기 수리', '교육·운동', '교육나라', 
    '교정시술/마사지', '교자상', '구두', '구두/신발', '국악기', '기계', '기계 수리', '기타', '기타 관련 수리', '네일', '네일숍', 
    '노래 연습장', '노래연습장', '놀이기구', '놀이시설', '다이어트', '당구장', '도장', '도자기 공예', '드레스', '등산·캠핑', '리빙', '마사지', 
    '매트리스', '모피', '무도', '문구', '문구점', '물품', '밀랍초/향초', '바디케어', '반려동물', '반려동물 미용', '반려동물 서비스', '반려동물용품', '발관리', 
    '발마사지', '배드민턴', '법무', '보육', '보절', '복지', '사진', '사진관', '사진촬영', '사회복지', '산악', '산후도우미', '상패', '서예', '성형', '세탁', 
    '세탁/다림질', '세탁소', '소파', '수영장', '수족관', '수지침', '스마트폰', '스마트폰/통신기기 수리', '스포츠·오락', '스포츠센터', '스포츠시설 운영', '시장조사', 
    '시험기기 수리', '식물', '신발', '신발/구두 수리', '실내 스크린골프장', '실내 골프연습장', '실내 오락시설', '실내체육시설', '실버', '쓰레기 수거', 
    '안경', '안경/콘택트 렌즈', '안마', '압구정', '야외', '야외/레저', '양복', '여가', '여성', '여행', '여행사', '영상', '온천', '와인', '운동', '원예', 
    '원예/조경 서비스', '유흥', '유흥/오락', '유치원', '이·미용', '이미용, 마사지', '이미용업', '인쇄', '인쇄·복사업', '인쇄소', '일반 수리', '자동차', 
    '자동차 수리', '자전거', '자전거 수리', '장례', '장례식장', '장식', '장식·광고물', '장식/광고물', '재활', '전기', '전기/전자 제품 수리', '전자', 
    '전자/가전제품 수리', '전자제품 수리', '전화', '전화기 수리', '전통', '전통놀이', '전화기·통신기기 수리', '정수기', '정수기 수리', '정원', '정원/조경', 
    '정형', '정형마사지', '제과', '제과제빵', '제빵', '종교', '종교 의식', '종교단체 서비스', '종교용품 수리', '주방', '주방용품 수리', '주택 관리', 
    '주택관리', '지압', '지하수정화', '진공', '진공청소기 수리', '차량', '차량·가정용품', '차량/자동차용품 수리', '창호', '천연', '철물', '청소', 
    '청소·방역', '청소업', '촬영', '카메라', '카메라 수리', '캠핑', '캐디', '콘택트', '콘택트렌즈', '타일', '탁구장', '탕', '터키', '테니스', '통신', 
    '통신기기 수리', '파티', '페인트', '펜션', '폼', '피부', '피부 관리', '피부관리', '피부미용', '피자', '하수구', '한복', '한복 대여', '헤어', '휴양', 
    '휴양시설', '휴양지 관리', '힐링'
]

EDU_KEYWORDS = [
    '검정고시', '공무원', '교습소', '국제·유학', '국제/유학', '기능', '기능·직업·컴퓨터', '기능/직업/컴퓨터', '기초학력·재교육', '기초학력/재교육', 
    '논술', '독서실', '무용', '미술', '방과후교실', '보습', '보육시설', '음악', '일반·보습', '일반/보습', '입시', '입시학원', '입시학원 (재수 포함)', '재교육', 
    '재수', '재수학원', '전문 기술 개발', '전문대학', '직업', '직업 전문 교육기관', '직업 전문학교', '직업능력개발', '직업학원', '초등', '체육', '컴퓨터', '학원', 
    '학교', '학교·학원', '학교/학원', '학원·교습소', '학원/교습소', '학습·입시', '학습/입시', '학습지', '해외', '해외유학'
]

MEDICAL_KEYWORDS = [
    '간호', '간호·간병', '간호/간병', '가정의학과의원', '건강', '건강관리', '건강검진센터', '검진', '검진센터', '겔러리', 
    '계단', '골절', '공공의료', '공중 보건', '공중보건', '관절', '교정', '구강', '구강·악안면외과', '국민건강보험', '국민보험', 
    '내과', '내과의원', '노인', '노인요양', '노인전문', '노인전문병원', '노인치과', '노인치료', '눈', '당뇨', '대학병원', '도수치료', 
    '두피', '마취과', '만성', '맑은', '모발', '목', '무릎', '문신제거', '비뇨', '비뇨의학과', '비뇨의학과의원', '비만', '사랑니', '산부인과', 
    '산부인과의원', '산후조리', '상담', '상담치료', '상처', '성형외과', '성형외과의원', '소아과', '소아청소년과', '소아청소년과의원', '소화기', '소화기내과', 
    '손·발', '손발', '수면', '수술', '스케일링', '스킨케어', '시력', '신경과', '신경외과', '신경정신과', '신경치료', '심리', '심리상담', '심장', '안과', 
    '암', '약국', '약국·의약품', '약국/의약품', '약사', '약제', '어린이병원', '어린이치과', '여성', '여성병원', '여성의원', '영상의학과', '영양', '예방접종', 
    '오라클', '외과', '외과의원', '요양', '요양병원', '운동치료', '응급', '응급의학과', '이비인후과', '이비인후과의원', '인공관절', '인플란트', '임플란트', 
    '임상', '자궁', '재활', '재활의학과', '재활치료', '저울', '정신건강', '정신과', '정신의학과', '정형', '정형/재활', '정형외과', '정형외과의원', '조산', 
    '종합병원', '주사', '치과', '치과 보철', '치과병원', '치과의원', '치주', '침술', '카이로', '피부', '피부과', '피부과의원', '피부병원', '피부클리닉', '피트니스', 
    '핑거', '한의', '한의원', '한방', '한방병원', '한방의원', '혈관', '혈액', '혈액투석', '호흡기', '호흡기내과', '흉부외과'
]

OFFICE_LUNCH_KEYWORDS = [
    '경양식', '구내식당', '구내식당·뷔페', '국/탕/찌개류', '국수', '국수/칼국수', '김밥', '김밥/만두/분식', '덮밥', '돈가스', 
    '백반', '백반/한정식', '분식', '뷔페', '샌드위치', '샐러드', '수제비', '식당', '정식', '정식·백반', '정식/백반', '죽', 
    '즉석', '즉석 떡볶이 전문', '즉석 샐러드/과일', '즉석 죽 전문', '즉석/테이크아웃', '찜·탕·찌개', '카레', '칼국수', '토스트', '패스트푸드', 
    '햄버거', '햄버거/샌드위치'
]

# 키워드 우선순위: 오피스런치 ▶ 의료 ▶ 교육 ▶ 생활서비스 ▶ F&B
WEIGHT_PRESETS = [
    (set(OFFICE_LUNCH_KEYWORDS), dict(flow=0.30, worker=0.45, resident=0.15, rent=0.10)),
    (set(MEDICAL_KEYWORDS),      dict(flow=0.10, worker=0.25, resident=0.35, rent=0.30)), # 가중치 조절
    (set(EDU_KEYWORDS),          dict(flow=0.20, worker=0.10, resident=0.50, rent=0.20)),
    (set(SERVICE_KEYWORDS),      dict(flow=0.25, worker=0.15, resident=0.45, rent=0.15)),
    (set(FNB_KEYWORDS),          dict(flow=0.50, worker=0.25, resident=0.15, rent=0.10)),
]

DEFAULT_WEIGHTS = dict(flow=0.40, worker=0.30, resident=0.20, rent=0.10)

def _norm(s: str) -> str:
    s = s.lower()
    s = re.sub(r"[\\s/·,]+", "", s)
    return s

def derive_weights_from_type(type_small: str) -> dict:
    if not isinstance(type_small, str) or not type_small.strip():
        return DEFAULT_WEIGHTS.copy()
    q = _norm(type_small)
    # 우선순위대로 첫 매칭을 채택
    for kw_set, w in WEIGHT_PRESETS:
        for kw in kw_set:
            k = _norm(kw)
            if k and (k in q or q in k):
                return w.copy()
    return DEFAULT_WEIGHTS.copy()
